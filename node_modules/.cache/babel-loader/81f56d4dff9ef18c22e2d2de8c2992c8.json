{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\Daniel Roncaglia\\\\Desktop\\\\share\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Daniel Roncaglia\\\\Desktop\\\\share\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Daniel Roncaglia\\\\Desktop\\\\share\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Daniel Roncaglia\\\\Desktop\\\\share\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Daniel Roncaglia\\\\Desktop\\\\share\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\Daniel Roncaglia\\\\Desktop\\\\share\\\\src\\\\App.js\";\nimport React, { Component } from 'react';\nimport ContentEditable from './components/ContentEditable';\nimport api from './utils/api';\nimport sortByDate from './utils/sortByDate';\nimport isLocalHost from './utils/isLocalHost';\nimport './App.css';\nimport { GiStairsGoal } from \"react-icons/fa\";\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      todos: [],\n      showMenu: false\n    };\n\n    _this.saveTodo = function (e) {\n      e.preventDefault();\n      var todos = _this.state.todos;\n      var todoValue = _this.inputElement.value;\n\n      if (!todoValue) {\n        alert('You need put one goal');\n\n        _this.inputElement.focus();\n\n        return false;\n      }\n\n      _this.inputElement.value = '';\n      var todoInfo = {\n        title: todoValue,\n        completed: false\n      };\n      var newTodoArray = [{\n        data: todoInfo,\n        ts: new Date().getTime() * 10000\n      }];\n      var optimisticTodoState = newTodoArray.concat(todos);\n\n      _this.setState({\n        todos: optimisticTodoState\n      });\n\n      api.create(todoInfo).then(function (response) {\n        console.log(response);\n        var persistedState = removeOptimisticTodo(todos).concat(response);\n\n        _this.setState({\n          todos: persistedState\n        });\n      }).catch(function (e) {\n        console.log('An API error occurred', e);\n        var revertedState = removeOptimisticTodo(todos);\n\n        _this.setState({\n          todos: revertedState\n        });\n      });\n    };\n\n    _this.deleteTodo = function (e) {\n      var todos = _this.state.todos;\n      var todoId = e.target.dataset.id;\n      var filteredTodos = todos.reduce(function (acc, current) {\n        var currentId = getTodoId(current);\n\n        if (currentId === todoId) {\n          acc.rollbackTodo = current;\n          return acc;\n        }\n\n        acc.optimisticState = acc.optimisticState.concat(current);\n        return acc;\n      }, {\n        rollbackTodo: {},\n        optimisticState: []\n      });\n\n      _this.setState({\n        todos: filteredTodos.optimisticState\n      });\n\n      api.delete(todoId).then(function () {\n        console.log(\"deleted todo id \".concat(todoId));\n      }).catch(function (e) {\n        console.log(\"There was an error removing \".concat(todoId), e);\n\n        _this.setState({\n          todos: filteredTodos.optimisticState.concat(filteredTodos.rollbackTodo)\n        });\n      });\n    };\n\n    _this.handleTodoCheckbox = function (event) {\n      var todos = _this.state.todos;\n      var target = event.target;\n      var todoCompleted = target.checked;\n      var todoId = target.dataset.id;\n      var updatedTodos = todos.map(function (todo, i) {\n        var data = todo.data;\n        var id = getTodoId(todo);\n\n        if (id === todoId && data.completed !== todoCompleted) {\n          data.completed = todoCompleted;\n        }\n\n        return todo;\n      });\n\n      _this.setState({\n        todos: updatedTodos\n      }, function () {\n        api.update(todoId, {\n          completed: todoCompleted\n        }).then(function () {\n          console.log(\"update todo \".concat(todoId), todoCompleted);\n        }).catch(function (e) {\n          console.log('An API error occurred', e);\n        });\n      });\n    };\n\n    _this.updateTodoTitle = function (event, currentValue) {\n      var isDifferent = false;\n      var todoId = event.target.dataset.key;\n\n      var updatedTodos = _this.state.todos.map(function (todo, i) {\n        var id = getTodoId(todo);\n\n        if (id === todoId && todo.data.title !== currentValue) {\n          todo.data.title = currentValue;\n          isDifferent = true;\n        }\n\n        return todo;\n      });\n\n      if (isDifferent) {\n        _this.setState({\n          todos: updatedTodos\n        }, function () {\n          api.update(todoId, {\n            title: currentValue\n          }).then(function () {\n            console.log(\"update todo \".concat(todoId), currentValue);\n          }).catch(function (e) {\n            console.log('An error occurred', e);\n          });\n        });\n      }\n    };\n\n    _this.clearCompleted = function () {\n      var todos = _this.state.todos;\n      var data = todos.reduce(function (acc, current) {\n        if (current.data.completed) {\n          acc.completedTodoIds = acc.completedTodoIds.concat(getTodoId(current));\n          return acc;\n        }\n\n        acc.optimisticState = acc.optimisticState.concat(current);\n        return acc;\n      }, {\n        completedTodoIds: [],\n        optimisticState: []\n      });\n\n      if (!data.completedTodoIds.length) {\n        alert('Please check off to batch remove');\n\n        _this.closeModal();\n\n        return false;\n      }\n\n      _this.setState({\n        todos: data.optimisticState\n      }, function () {\n        setTimeout(function () {\n          _this.closeModal();\n        }, 600);\n        api.batchDelete(data.completedTodoIds).then(function () {\n          console.log(\"Batch removal complete\", data.completedTodoIds);\n        }).catch(function (e) {\n          console.log('An API error occurred', e);\n        });\n      });\n    };\n\n    _this.closeModal = function (e) {\n      _this.setState({\n        showMenu: false\n      });\n    };\n\n    _this.openModal = function () {\n      _this.setState({\n        showMenu: true\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      api.readAll().then(function (todos) {\n        if (todos.message === 'unauthorized') {\n          if (isLocalHost()) {\n            alert('Key is not unauthorized');\n          }\n\n          return false;\n        }\n\n        console.log('all todos', todos);\n\n        _this2.setState({\n          todos: todos\n        });\n      });\n    }\n  }, {\n    key: \"renderTodos\",\n    value: function renderTodos() {\n      var _this3 = this;\n\n      var todos = this.state.todos;\n\n      if (!todos || !todos.length) {\n        return null;\n      }\n\n      var timeStampKey = 'ts';\n      var orderBy = 'desc';\n      var sortOrder = sortByDate(timeStampKey, orderBy);\n      var todosByDate = todos.sort(sortOrder);\n      return todosByDate.map(function (todo, i) {\n        var data = todo.data,\n            ref = todo.ref;\n        var id = getTodoId(todo);\n        var deleteButton;\n\n        if (ref) {\n          deleteButton = React.createElement(\"button\", {\n            \"data-id\": id,\n            onClick: _this3.deleteTodo,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 224\n            },\n            __self: this\n          }, \"delete\");\n        }\n\n        return React.createElement(\"div\", {\n          key: i,\n          className: \"todo-item\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 231\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          className: \"todo\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"todo-list-title\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 234\n          },\n          __self: this\n        }, React.createElement(ContentEditable, {\n          tagName: \"span\",\n          editKey: id,\n          onBlur: _this3.updateTodoTitle,\n          html: data.title,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 235\n          },\n          __self: this\n        }), deleteButton)));\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return React.createElement(\"div\", {\n        className: \"app\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        },\n        __self: this\n      }, React.createElement(\"header\", {\n        className: \"header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"header-left-nav\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"header-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }, \"Share Goals  \"), React.createElement(\"h2\", {\n        className: \"header-title2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261\n        },\n        __self: this\n      }, \"Define objectives, set a deadline and show up the achieves\"))), React.createElement(\"div\", {\n        className: \"todo-list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        className: \"todo-create-wrapper\",\n        onSubmit: this.saveTodo,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 269\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"todo-create-input\",\n        placeholder: \"Start a new goal\",\n        name: \"name\",\n        ref: function ref(el) {\n          return _this4.inputElement = el;\n        },\n        autoComplete: \"off\",\n        style: {\n          marginRight: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        className: \"todo-create-input\",\n        type: \"date\",\n        style: {\n          marginRight: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        className: \"todo-create-input\",\n        type: \"number\",\n        placeholder: \"Initial number\",\n        style: {\n          marginRight: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        className: \"todo-create-input\",\n        type: \"number\",\n        placeholder: \"Final number\",\n        style: {\n          marginRight: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        className: \"todo-create-input\",\n        type: \"option\",\n        placeholder: \"Type\",\n        style: {\n          marginRight: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"todo-actions\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"todo-create-button\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304\n        },\n        __self: this\n      }, \"NEW CHALLENGE\"))), this.renderTodos()), React.createElement(\"footer\", {\n        className: \"footer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 314\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"footer-left-nav\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315\n        },\n        __self: this\n      }, React.createElement(\"ul\", {\n        className: \"footer-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      }, \"Daniel Roncaglia\"), React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319\n        },\n        __self: this\n      }, \"S\\xE3o Paulo - Brasil\"), React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320\n        },\n        __self: this\n      }, \"+55 (11) 97286-1722\"), React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 321\n        },\n        __self: this\n      }, \"daniel.roncaglia@gmail.com\")))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport { App as default };\n\nfunction removeOptimisticTodo(todos) {\n  return todos.filter(function (todo) {\n    return todo.ref;\n  });\n}\n\nfunction getTodoId(todo) {\n  if (!todo.ref) {\n    return null;\n  }\n\n  return todo.ref['@ref'].id;\n}","map":{"version":3,"sources":["C:\\Users\\Daniel Roncaglia\\Desktop\\share\\src\\App.js"],"names":["React","Component","ContentEditable","api","sortByDate","isLocalHost","GiStairsGoal","App","state","todos","showMenu","saveTodo","e","preventDefault","todoValue","inputElement","value","alert","focus","todoInfo","title","completed","newTodoArray","data","ts","Date","getTime","optimisticTodoState","concat","setState","create","then","response","console","log","persistedState","removeOptimisticTodo","catch","revertedState","deleteTodo","todoId","target","dataset","id","filteredTodos","reduce","acc","current","currentId","getTodoId","rollbackTodo","optimisticState","delete","handleTodoCheckbox","event","todoCompleted","checked","updatedTodos","map","todo","i","update","updateTodoTitle","currentValue","isDifferent","key","clearCompleted","completedTodoIds","length","closeModal","setTimeout","batchDelete","openModal","readAll","message","timeStampKey","orderBy","sortOrder","todosByDate","sort","ref","deleteButton","el","marginRight","renderTodos","filter"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport ContentEditable from './components/ContentEditable'\r\nimport api from './utils/api'\r\nimport sortByDate from './utils/sortByDate'\r\nimport isLocalHost from './utils/isLocalHost'\r\nimport './App.css'\r\nimport { GiStairsGoal } from \"react-icons/fa\"\r\n\r\nexport default class App extends Component {\r\n  state = {\r\n    todos: [],\r\n    showMenu: false\r\n  }\r\n  componentDidMount() {\r\n\r\n    api.readAll().then((todos) => {\r\n      if (todos.message === 'unauthorized') {\r\n        if (isLocalHost()) {\r\n          alert('Key is not unauthorized')\r\n        }\r\n        return false\r\n      }\r\n\r\n      console.log('all todos', todos)\r\n      this.setState({\r\n        todos: todos\r\n      })\r\n    })\r\n  }\r\n\r\n  saveTodo = (e) => {\r\n    e.preventDefault()\r\n    const { todos } = this.state\r\n    const todoValue = this.inputElement.value\r\n\r\n    if (!todoValue) {\r\n      alert('You need put one goal')\r\n      this.inputElement.focus()\r\n      return false\r\n    }\r\n\r\n    this.inputElement.value = ''\r\n\r\n    const todoInfo = {\r\n      title: todoValue,\r\n      completed: false,\r\n    }\r\n\r\n    const newTodoArray = [{\r\n      data: todoInfo,\r\n      ts: new Date().getTime() * 10000\r\n    }]\r\n\r\n    const optimisticTodoState = newTodoArray.concat(todos)\r\n\r\n    this.setState({\r\n      todos: optimisticTodoState\r\n    })\r\n\r\n    api.create(todoInfo).then((response) => {\r\n      console.log(response)\r\n      const persistedState = removeOptimisticTodo(todos).concat(response)\r\n      this.setState({\r\n        todos: persistedState\r\n      })\r\n    }).catch((e) => {\r\n      console.log('An API error occurred', e)\r\n      const revertedState = removeOptimisticTodo(todos)\r\n      this.setState({\r\n        todos: revertedState\r\n      })\r\n    })\r\n  }\r\n  deleteTodo = (e) => {\r\n    const { todos } = this.state\r\n    const todoId = e.target.dataset.id\r\n\r\n    const filteredTodos = todos.reduce((acc, current) => {\r\n      const currentId = getTodoId(current)\r\n      if (currentId === todoId) {\r\n        acc.rollbackTodo = current\r\n        return acc\r\n      }\r\n      acc.optimisticState = acc.optimisticState.concat(current)\r\n      return acc\r\n    }, {\r\n      rollbackTodo: {},\r\n      optimisticState: []\r\n    })\r\n\r\n    this.setState({\r\n      todos: filteredTodos.optimisticState\r\n    })\r\n\r\n    api.delete(todoId).then(() => {\r\n      console.log(`deleted todo id ${todoId}`)\r\n    }).catch((e) => {\r\n      console.log(`There was an error removing ${todoId}`, e)\r\n      this.setState({\r\n        todos: filteredTodos.optimisticState.concat(filteredTodos.rollbackTodo)\r\n      })\r\n    })\r\n  }\r\n  handleTodoCheckbox = (event) => {\r\n    const { todos } = this.state\r\n    const { target } = event\r\n    const todoCompleted = target.checked\r\n    const todoId = target.dataset.id\r\n\r\n    const updatedTodos = todos.map((todo, i) => {\r\n      const { data } = todo\r\n      const id = getTodoId(todo)\r\n      if (id === todoId && data.completed !== todoCompleted) {\r\n        data.completed = todoCompleted\r\n      }\r\n      return todo\r\n    })\r\n\r\n    this.setState({\r\n      todos: updatedTodos\r\n    }, () => {\r\n      api.update(todoId, {\r\n        completed: todoCompleted\r\n      }).then(() => {\r\n        console.log(`update todo ${todoId}`, todoCompleted)\r\n      }).catch((e) => {\r\n        console.log('An API error occurred', e)\r\n      })\r\n    })\r\n  }\r\n  updateTodoTitle = (event, currentValue) => {\r\n    let isDifferent = false\r\n    const todoId = event.target.dataset.key\r\n\r\n    const updatedTodos = this.state.todos.map((todo, i) => {\r\n      const id = getTodoId(todo)\r\n      if (id === todoId && todo.data.title !== currentValue) {\r\n        todo.data.title = currentValue\r\n        isDifferent = true\r\n      }\r\n      return todo\r\n    })\r\n\r\n    if (isDifferent) {\r\n      this.setState({\r\n        todos: updatedTodos\r\n      }, () => {\r\n        api.update(todoId, {\r\n          title: currentValue\r\n        }).then(() => {\r\n          console.log(`update todo ${todoId}`, currentValue)\r\n        }).catch((e) => {\r\n          console.log('An error occurred', e)\r\n        })\r\n      })\r\n    }\r\n  }\r\n  clearCompleted = () => {\r\n    const { todos } = this.state\r\n\r\n    const data = todos.reduce((acc, current) => {\r\n      if (current.data.completed) {\r\n        acc.completedTodoIds = acc.completedTodoIds.concat(getTodoId(current))\r\n        return acc\r\n      }\r\n      acc.optimisticState = acc.optimisticState.concat(current)\r\n      return acc\r\n    }, {\r\n      completedTodoIds: [],\r\n      optimisticState: []\r\n    })\r\n\r\n    if (!data.completedTodoIds.length) {\r\n      alert('Please check off to batch remove')\r\n      this.closeModal()\r\n      return false\r\n    }\r\n\r\n    this.setState({\r\n      todos: data.optimisticState\r\n    }, () => {\r\n      setTimeout(() => {\r\n        this.closeModal()\r\n      }, 600)\r\n\r\n      api.batchDelete(data.completedTodoIds).then(() => {\r\n        console.log(`Batch removal complete`, data.completedTodoIds)\r\n      }).catch((e) => {\r\n        console.log('An API error occurred', e)\r\n      })\r\n    })\r\n  }\r\n  closeModal = (e) => {\r\n    this.setState({\r\n      showMenu: false\r\n    })\r\n  }\r\n  openModal = () => {\r\n    this.setState({\r\n      showMenu: true\r\n    })\r\n  }\r\n  renderTodos() {\r\n    const { todos } = this.state\r\n\r\n    if (!todos || !todos.length) {\r\n      return null\r\n    }\r\n\r\n    const timeStampKey = 'ts'\r\n    const orderBy = 'desc'\r\n    const sortOrder = sortByDate(timeStampKey, orderBy)\r\n    const todosByDate = todos.sort(sortOrder)\r\n\r\n    return todosByDate.map((todo, i) => {\r\n\r\n      const { data, ref } = todo\r\n      const id = getTodoId(todo)\r\n\r\n      let deleteButton\r\n\r\n      if (ref) {\r\n        deleteButton = (\r\n          <button data-id={id} onClick={this.deleteTodo}>\r\n            delete\r\n          </button>\r\n        )\r\n      }\r\n\r\n      return (\r\n        <div key={i} className='todo-item'>\r\n          <label className=\"todo\">\r\n\r\n            <div className='todo-list-title'>\r\n              <ContentEditable\r\n                tagName='span'\r\n                editKey={id}\r\n                onBlur={this.updateTodoTitle}\r\n                html={data.title}\r\n              />\r\n\r\n              {deleteButton}\r\n\r\n            </div>\r\n\r\n          </label>\r\n\r\n\r\n\r\n        </div>\r\n      )\r\n    })\r\n  }\r\n  render() {\r\n    return (\r\n      <div className='app'>\r\n\r\n        <header className='header'>\r\n          <div className='header-left-nav'>\r\n            <h1 className='header-title'>Share Goals  </h1>\r\n            <h2 className='header-title2'>Define objectives,\r\n                set a deadline and show up the achieves \r\n            </h2>\r\n          </div>\r\n        </header>\r\n\r\n        <div className='todo-list'>\r\n\r\n          <form className='todo-create-wrapper' onSubmit={this.saveTodo}>\r\n\r\n            <input\r\n              className='todo-create-input'\r\n              placeholder='Start a new goal'\r\n              name='name'\r\n              ref={el => this.inputElement = el}\r\n              autoComplete='off'\r\n              style={{ marginRight: 20 }}\r\n            />\r\n\r\n            <input\r\n              className='todo-create-input'\r\n              type=\"date\"\r\n              style={{ marginRight: 20 }} />\r\n\r\n            <input\r\n              className='todo-create-input'\r\n              type=\"number\"\r\n              placeholder='Initial number'\r\n              style={{ marginRight: 20 }} />\r\n\r\n            <input\r\n              className='todo-create-input'\r\n              type=\"number\"\r\n              placeholder='Final number'\r\n              style={{ marginRight: 20 }} />\r\n\r\n            <input\r\n              className='todo-create-input'\r\n              type=\"option\"\r\n              placeholder='Type'\r\n              style={{ marginRight: 20 }} />\r\n\r\n            <div className='todo-actions'>\r\n              <button className='todo-create-button'>\r\n                NEW CHALLENGE\r\n              </button>\r\n            </div>\r\n          </form>\r\n\r\n          {this.renderTodos()}\r\n\r\n        </div>\r\n\r\n        <footer className=\"footer\">\r\n          <div className='footer-left-nav'>\r\n\r\n            <ul className='footer-text'>\r\n              <li>Daniel Roncaglia</li>\r\n              <li>São Paulo - Brasil</li>\r\n              <li>+55 (11) 97286-1722</li>\r\n              <li>daniel.roncaglia@gmail.com</li>\r\n            </ul>\r\n          </div>\r\n        </footer>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nfunction removeOptimisticTodo(todos) {\r\n  return todos.filter((todo) => {\r\n    return todo.ref\r\n  })\r\n}\r\n\r\nfunction getTodoId(todo) {\r\n  if (!todo.ref) {\r\n    return null\r\n  }\r\n  return todo.ref['@ref'].id\r\n}\r\n"]},"metadata":{},"sourceType":"module"}